{"version":3,"sources":["whitewater.js"],"names":["Whitewater","canvas","inputPath","options","context","imageIndex","coordinates","x","y","imagesLoaded","firstImage","Image","diffImages","animationFrame","frames","manifest","path","settings","hiddenProperty","documentHidden","buffer","bufferContext","this","state","currentFrame","progress","timestamp","maxTime","secondsElapsed","addCanvasMethods","play","pause","playpause","stop","bind","addVisibilityListener","document","addEventListener","softPause","window","checkImagesLoaded","imagesRequired","setAttribute","loadEvent","CustomEvent","getEventOptions","dispatchEvent","autoplay","drawFrame","frameToDraw","getPrecompositedFrame","drawImage","setProgress","detail","video","bubbles","cancelable","frameToRender","clearRect","videoWidth","videoHeight","j","length","position","consecutive","positionArray","getCoordinatesFromPosition","chunkWidth","blockSize","sourceGrid","loadRequiredImages","setPosterImage","src","format","i","image","push","parseManifestFile","callbacks","onManifestLoad","JSON","parse","request","responseText","error","constructor","_throwError","setVideoOptions","setSize","myWorker","webWorker","toBase10","val","r","order","num","indexOf","charAt","substr","workerIsIncluded","onmessage","e","data","videoData","frame","frameData","map","match","mapLength","postMessage","URL","webkitURL","workerBlob","Blob","toString","type","Worker","createObjectURL","event","terminate","controls","setPlayPauseControls","onManifestError","errors","MANIFEST","XMLHttpRequest","open","send","resetVideo","setCanvasElement","HTMLCanvasElement","CANVAS","getContext","createElement","setFilePath","PATH","setOptions","speed","loop","element","clickEvent","getClickEvent","top","style","paddingTop","background","backgroundSize","getNumberWithDecimals","frameCount","currentTime","framesPerSecond","getFormattedTime","width","height","Math","round","lengthInSeconds","hidden","undefined","Video","init","documentElement","columns","ceil","floor","time","minutes","seconds","milliseconds","number","digits","multiplier","pow","pauseEvent","cancelAnimationFrame","animate","timeSinceLastDraw","previousTime","interval","loopEvent","endEvent","requestAnimationFrame","resume","playEvent","performance","now","supported","pre","MISC","WEBWORKERS","BLOBCONSTRUCTOR","VISIBILITYAPI","_checkSupport","console","warn"],"mappings":"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","file":"whitewater.min.js"}